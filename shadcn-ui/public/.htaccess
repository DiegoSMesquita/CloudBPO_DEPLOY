# Apache configuration for SPA routing
# Solução definitiva para erro 404 em SPAs

RewriteEngine On

# Handle Angular and React Router
# Se o arquivo não existe E não é um diretório
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Redireciona rotas específicas do sistema para 404.html
RewriteRule ^mobile/counting/(.*)$ /404.html [L]
RewriteRule ^counting/(.*)$ /404.html [L]
RewriteRule ^login$ /404.html [L]
RewriteRule ^dashboard(.*)$ /404.html [L]

# Fallback geral para outras rotas SPA
RewriteRule . /404.html [L]

# Headers para melhor performance
<IfModule mod_headers.c>
    Header always set X-Frame-Options DENY
    Header always set X-Content-Type-Options nosniff
</IfModule>

# Compressão
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>